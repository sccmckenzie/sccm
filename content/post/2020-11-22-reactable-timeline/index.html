---
title: Simple Reactable Timeline in R
description: 'Extend reactable framework to accommodate simple Gantt chart'
author: Scott McKenzie
date: '2020-11-22'
slug: reactable-timeline
categories: []
tags: 
  - reactable
  - R
  - timeline
---

<script src="index_files/header-attrs/header-attrs.js"></script>
<script src="index_files/core-js/shim.min.js"></script>
<script src="index_files/react/react.min.js"></script>
<script src="index_files/react/react-dom.min.js"></script>
<script src="index_files/reactwidget/react-tools.js"></script>
<script src="index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="index_files/reactable-binding/reactable.js"></script>


<p>In this post, I will demonstrate how to create the below timeline using <a href="https://glin.github.io/reactable/">reactable</a>.</p>
<div id="htmlwidget-1" class="reactable html-widget" style="width:905px;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"customer":[1,2,3,4,5,6,7,8,9,10],"revenue":[7.0236984300882,10.7477403340045,44.6027851477405,60.396119098701,21.8778083049617,9.94439370973172,51.6726620455256,28.1531880284289,0,0],"enter":["2020-02-03T18:41:21","2020-02-03T08:55:16","2020-02-03T17:36:45","2020-02-03T11:37:17","2020-02-03T10:26:42","2020-02-03T12:25:05","2020-02-03T08:47:50","2020-02-03T08:01:37","2020-02-03T09:30:28","2020-02-03T10:06:39"],"exit":["2020-02-03T19:44:13","2020-02-03T09:48:49","2020-02-03T19:06:44","2020-02-03T13:28:29","2020-02-03T11:27:42","2020-02-03T13:19:32","2020-02-03T10:28:34","2020-02-03T09:00:01","2020-02-03T10:01:41","2020-02-03T10:29:46"],"timestamps":[[[0.910522820001898],[0.0894771799981023]],[[0.0763592371192713],[0.0762169086251067]],[[0.81857861277161],[0.128071923332384]],[[0.306955119081507],[0.158269285510959]],[[0.206494923617041],[0.0868203814403644]],[[0.374988139292153],[0.0774978650725875]],[[0.0657794857197078],[0.143372236455072]],[[0],[0.0831198405920865]],[[0.126458867065186],[0.044430211595028]],[[0.177958060537053],[0.0329016035677009]]]},"columns":[{"accessor":"customer","name":"customer","type":"numeric","width":100},{"accessor":"revenue","name":"revenue","type":"numeric","format":{"cell":{"digits":1},"aggregated":{"digits":1}},"width":100},{"accessor":"enter","name":"enter","type":"Date","format":{"cell":{"datetime":true},"aggregated":{"datetime":true}},"width":200},{"accessor":"exit","name":"exit","type":"Date","format":{"cell":{"datetime":true},"aggregated":{"datetime":true}},"width":200},{"accessor":"timestamps","name":"timestamps","type":"list","cell":[{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"91%","background":"#00bfc4","width":"9%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"8%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"82%","background":"#00bfc4","width":"13%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"31%","background":"#00bfc4","width":"16%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"21%","background":"#00bfc4","width":"9%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"37%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"7%","background":"#00bfc4","width":"14%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"0%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"13%","background":"#00bfc4","width":"4%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"18%","background":"#00bfc4","width":"3%","height":"140%"}},"children":[]}]}]}],"width":300}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"bordered":true,"compact":true,"inline":true,"width":"905px","dataKey":"3f701d39c3148caa57959d06450391c9","key":"3f701d39c3148caa57959d06450391c9"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<br/>
<div id="motivation" class="section level3">
<h3>Motivation</h3>
<p>I’ve wanted to create an interactive timeline for awhile. There are a lot of great R timeline packages out there, but none of them really fit my needs.</p>
<p>I’m a huge fan of the reactable package, mainly for its sleek look and customizability. As a result, I had already invested a lot of time integrating “reactables” into my reports. Rather than annihilating my work hitherto, I needed a solution to augment my existing reactables with a graphical timeline.</p>
<p><strong>The beauty of this solution is that it preserves the tabular framework of reactable.</strong></p>
<p>First, let’s load the data.</p>
<pre class="r"><code>library(tidyverse)

store_records &lt;- read_csv(&quot;https://raw.githubusercontent.com/sccmckenzie/reactable-timeline/master/customer_df.csv&quot;)</code></pre>
<p>This is a simple dataset that I created for demonstration. It contains store records of customer revenue for 2020-02-03.</p>
<ul>
<li>customer: Unique customer ID</li>
<li>revenue: Total revenue from items purchased by customer</li>
<li>enter: Time when customer enters store</li>
<li>exit: Time when customer exits store</li>
</ul>
<pre class="r"><code>store_records</code></pre>
<pre><code>## # A tibble: 10 x 4
##    customer revenue enter               exit               
##       &lt;dbl&gt;   &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;             
##  1        1    7.02 2020-02-03 18:41:21 2020-02-03 19:44:13
##  2        2   10.7  2020-02-03 08:55:16 2020-02-03 09:48:49
##  3        3   44.6  2020-02-03 17:36:45 2020-02-03 19:06:44
##  4        4   60.4  2020-02-03 11:37:17 2020-02-03 13:28:29
##  5        5   21.9  2020-02-03 10:26:42 2020-02-03 11:27:42
##  6        6    9.94 2020-02-03 12:25:05 2020-02-03 13:19:32
##  7        7   51.7  2020-02-03 08:47:50 2020-02-03 10:28:34
##  8        8   28.2  2020-02-03 08:01:37 2020-02-03 09:00:01
##  9        9    0    2020-02-03 09:30:28 2020-02-03 10:01:41
## 10       10    0    2020-02-03 10:06:39 2020-02-03 10:29:46</code></pre>
<p>Our goal is to project <code>enter</code> and <code>exit</code> into a “timeline column”.</p>
</div>
<div id="step-1-define-time-transform-function" class="section level3">
<h3>Step 1: Define time transform function</h3>
<p><code>convert_timestamps</code> will take <code>enter</code> and <code>exit</code>, normalize, merge, then return as <code>list</code>.</p>
<pre class="r"><code>library(lubridate) # needed for time_length()

convert_timestamps &lt;- function(t1, t2) {
  # extract timestamp range
  t01 &lt;- min(t1)
  t02 &lt;- max(t2)
  
  # normalize event timestamps within total range
  left &lt;- time_length(t1 - t01)/time_length(t02 - t01)
  width &lt;- time_length(t2 - t1)/time_length(t02 - t01)
  
  # splice values into list
  out &lt;- list()
  
  for (i in 1:length(left)) {
    out[[i]] &lt;- list(left[i], width[i])
  }
  
  out
}</code></pre>
<p>Example:</p>
<pre class="r"><code>store_records %&gt;% 
  mutate(timestamps = convert_timestamps(enter, exit))</code></pre>
<pre><code>## # A tibble: 10 x 5
##    customer revenue enter               exit                timestamps
##       &lt;dbl&gt;   &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;list&gt;    
##  1        1    7.02 2020-02-03 18:41:21 2020-02-03 19:44:13 &lt;list [2]&gt;
##  2        2   10.7  2020-02-03 08:55:16 2020-02-03 09:48:49 &lt;list [2]&gt;
##  3        3   44.6  2020-02-03 17:36:45 2020-02-03 19:06:44 &lt;list [2]&gt;
##  4        4   60.4  2020-02-03 11:37:17 2020-02-03 13:28:29 &lt;list [2]&gt;
##  5        5   21.9  2020-02-03 10:26:42 2020-02-03 11:27:42 &lt;list [2]&gt;
##  6        6    9.94 2020-02-03 12:25:05 2020-02-03 13:19:32 &lt;list [2]&gt;
##  7        7   51.7  2020-02-03 08:47:50 2020-02-03 10:28:34 &lt;list [2]&gt;
##  8        8   28.2  2020-02-03 08:01:37 2020-02-03 09:00:01 &lt;list [2]&gt;
##  9        9    0    2020-02-03 09:30:28 2020-02-03 10:01:41 &lt;list [2]&gt;
## 10       10    0    2020-02-03 10:06:39 2020-02-03 10:29:46 &lt;list [2]&gt;</code></pre>
</div>
<div id="step-2-define-html-helper" class="section level3">
<h3>Step 2: Define html helper</h3>
<p><code>reactable()</code> will feed output from <code>convert_timestamps</code> into <code>create_timeline_bar</code>, producing our final output.</p>
<pre class="r"><code>library(htmltools) # needed for div()

create_timeline_bar &lt;- function(left = 0, width = &quot;100%&quot;, fill = &quot;#00bfc4&quot;) {
  left &lt;- scales::percent(left)
  width &lt;- scales::percent(width)
  
  bar &lt;- div(style = list(
    position = &quot;absolute&quot;,
    left = left,
    background = fill,
    width = width,
    height = &quot;140%&quot;)
  )
  
  chart &lt;- div(style = list(
    flexGrow = 1,
    position = &quot;relative&quot;,
    display = &quot;flex&quot;,
    alignItems = &quot;center&quot;,
    height = &quot;100%&quot;
  ), 
  bar)
  
  div(style = list(
    height = &quot;100%&quot;
  ), 
  chart)
}</code></pre>
</div>
<div id="final-product" class="section level3">
<h3>Final product</h3>
<pre class="r"><code>library(reactable)

store_records %&gt;% 
  mutate(timestamps = convert_timestamps(enter, exit)) %&gt;% 
  # ^ created in Step 1
  reactable(fullWidth = FALSE,
            width = 905,
            compact = TRUE,
            bordered = TRUE,
            columns = list(
              customer = colDef(width = 100),
              revenue = colDef(width = 100, format = colFormat(digits = 1)),
              enter = colDef(width = 200, format = colFormat(datetime = TRUE)),
              exit = colDef(width = 200, format = colFormat(datetime = TRUE)),
              timestamps = colDef(
                width = 300,
                cell = function(value) {
                  create_timeline_bar(left = value[[1]], width = value[[2]])
                  # ^ created in Step 2
                }
              )
            )
)</code></pre>
<div id="htmlwidget-2" class="reactable html-widget" style="width:905px;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"customer":[1,2,3,4,5,6,7,8,9,10],"revenue":[7.0236984300882,10.7477403340045,44.6027851477405,60.396119098701,21.8778083049617,9.94439370973172,51.6726620455256,28.1531880284289,0,0],"enter":["2020-02-03T18:41:21","2020-02-03T08:55:16","2020-02-03T17:36:45","2020-02-03T11:37:17","2020-02-03T10:26:42","2020-02-03T12:25:05","2020-02-03T08:47:50","2020-02-03T08:01:37","2020-02-03T09:30:28","2020-02-03T10:06:39"],"exit":["2020-02-03T19:44:13","2020-02-03T09:48:49","2020-02-03T19:06:44","2020-02-03T13:28:29","2020-02-03T11:27:42","2020-02-03T13:19:32","2020-02-03T10:28:34","2020-02-03T09:00:01","2020-02-03T10:01:41","2020-02-03T10:29:46"],"timestamps":[[[0.910522820001898],[0.0894771799981023]],[[0.0763592371192713],[0.0762169086251067]],[[0.81857861277161],[0.128071923332384]],[[0.306955119081507],[0.158269285510959]],[[0.206494923617041],[0.0868203814403644]],[[0.374988139292153],[0.0774978650725875]],[[0.0657794857197078],[0.143372236455072]],[[0],[0.0831198405920865]],[[0.126458867065186],[0.044430211595028]],[[0.177958060537053],[0.0329016035677009]]]},"columns":[{"accessor":"customer","name":"customer","type":"numeric","width":100},{"accessor":"revenue","name":"revenue","type":"numeric","format":{"cell":{"digits":1},"aggregated":{"digits":1}},"width":100},{"accessor":"enter","name":"enter","type":"Date","format":{"cell":{"datetime":true},"aggregated":{"datetime":true}},"width":200},{"accessor":"exit","name":"exit","type":"Date","format":{"cell":{"datetime":true},"aggregated":{"datetime":true}},"width":200},{"accessor":"timestamps","name":"timestamps","type":"list","cell":[{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"91%","background":"#00bfc4","width":"9%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"8%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"82%","background":"#00bfc4","width":"13%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"31%","background":"#00bfc4","width":"16%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"21%","background":"#00bfc4","width":"9%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"37%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"7%","background":"#00bfc4","width":"14%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"0%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"13%","background":"#00bfc4","width":"4%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"18%","background":"#00bfc4","width":"3%","height":"140%"}},"children":[]}]}]}],"width":300}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"bordered":true,"compact":true,"inline":true,"width":"905px","dataKey":"3f701d39c3148caa57959d06450391c9","key":"3f701d39c3148caa57959d06450391c9"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
