---
title: Simple Reactable Timeline in R
description: 'Extend reactable framework to accommodate simple Gantt chart'
author: Scott McKenzie
date: '2020-11-22'
slug: reactable-timeline
categories: []
tags: 
  - reactable
  - R
  - timeline
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index_files/core-js/shim.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/react/react.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/react/react-dom.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/reactwidget/react-tools.js"></script>
<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index_files/reactable-binding/reactable.js"></script>


<p>In this post, I will demonstrate how to create the below timeline using <a href="https://glin.github.io/reactable/">reactable</a>.</p>
<div id="htmlwidget-1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"c_id":[1,2,3,4,5,6,7,8,9,10],"revenue":[23.2980777195814,21.4335567209224,44.8611822126433,57.2003552325714,27.6266204817329,21.4633937190885,50.8019767005564,28.8549955645461,0.610091666646836,5.44092230565478],"enter":["18:41:00","08:55:00","17:37:00","11:37:00","10:27:00","12:25:00","08:48:00","08:02:00","09:30:00","10:07:00"],"exit":["19:44:00","09:49:00","19:07:00","13:28:00","11:28:00","13:20:00","10:29:00","09:00:00","10:02:00","10:30:00"],"timeline":[[[0.91025641025641],[0.0897435897435897]],[[0.0754985754985755],[0.0769230769230769]],[[0.819088319088319],[0.128205128205128]],[[0.306267806267806],[0.158119658119658]],[[0.206552706552707],[0.0868945868945869]],[[0.374643874643875],[0.0783475783475783]],[[0.0655270655270655],[0.143874643874644]],[[0],[0.0826210826210826]],[[0.125356125356125],[0.0455840455840456]],[[0.178062678062678],[0.0327635327635328]]]},"columns":[{"accessor":"c_id","name":"c_id","type":"numeric","width":55},{"accessor":"revenue","name":"revenue","type":"numeric","show":false,"format":{"cell":{"digits":1},"aggregated":{"digits":1}},"width":90},{"accessor":"enter","name":"enter","type":["hms","difftime"],"width":80},{"accessor":"exit","name":"exit","type":["hms","difftime"],"width":80},{"accessor":"timeline","name":"timeline","type":"list","cell":[{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"91%","background":"#00bfc4","width":"9%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"8%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"82%","background":"#00bfc4","width":"13%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"31%","background":"#00bfc4","width":"16%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"21%","background":"#00bfc4","width":"9%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"37%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"7%","background":"#00bfc4","width":"14%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"0%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"13%","background":"#00bfc4","width":"5%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"18%","background":"#00bfc4","width":"3%","height":"140%"}},"children":[]}]}]}],"width":90}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"bordered":true,"compact":true,"inline":true,"dataKey":"371375ac302dd55688c5c22021959b41","key":"371375ac302dd55688c5c22021959b41"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p><br/></p>
<div id="motivation" class="section level3">
<h3>Motivation</h3>
<p>I’ve wanted to create an interactive timeline for awhile. There are a lot of great R timeline packages out there, but none of them really fit my needs.</p>
<p>I’m a huge fan of the reactable package, mainly for its sleek look and customizability. As a result, I had already invested a lot of time integrating “reactables” into my reports. Rather than annihilating my work hitherto, I needed a solution to augment my existing reactables with a graphical timeline.</p>
<p><strong>The beauty of this solution is that it preserves the tabular framework of reactable.</strong></p>
<p>First, let’s load the data.</p>
<pre class="r"><code>sales &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/sccmckenzie/reactable-timeline/master/sales.csv&quot;)</code></pre>
<p>This is a simple dataset that I created for demonstration. It contains store records of customer revenue.</p>
<ul>
<li>c_id: Unique customer ID</li>
<li>revenue: Total revenue from items purchased by customer</li>
<li>enter: Time when customer enters store</li>
<li>exit: Time when customer exits store</li>
</ul>
<pre class="r"><code>sales</code></pre>
<pre><code>## # A tibble: 10 x 4
##     c_id revenue enter  exit  
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;time&gt; &lt;time&gt;
##  1     1  23.3   18:41  19:44 
##  2     2  21.4   08:55  09:49 
##  3     3  44.9   17:37  19:07 
##  4     4  57.2   11:37  13:28 
##  5     5  27.6   10:27  11:28 
##  6     6  21.5   12:25  13:20 
##  7     7  50.8   08:48  10:29 
##  8     8  28.9   08:02  09:00 
##  9     9   0.610 09:30  10:02 
## 10    10   5.44  10:07  10:30</code></pre>
<p>Our goal is to project <code>enter</code> and <code>exit</code> into a “timeline column”.</p>
</div>
<div id="step-0-libraries" class="section level3">
<h3>Step 0: Libraries</h3>
<p>This solution requires the below packages:</p>
<pre class="r"><code>library(tidyverse)
library(lubridate) # needed for time_length()
library(htmltools) # needed for div()
library(reactable)</code></pre>
</div>
<div id="step-1-define-time-transform-function" class="section level3">
<h3>Step 1: Define time transform function</h3>
<p><code>convert_timestamps</code> will take <code>enter</code> and <code>exit</code>, normalize, merge, then return as <code>list</code>.</p>
<pre class="r"><code>convert_timestamps &lt;- function(t1, t2) {
  # extract timestamp range
  t01 &lt;- min(t1)
  t02 &lt;- max(t2)

  # normalize event timestamps within total range
  left &lt;- time_length(t1 - t01)/time_length(t02 - t01)
  width &lt;- time_length(t2 - t1)/time_length(t02 - t01)

  # splice values into list
  out &lt;- list()

  for (i in 1:length(left)) {
    out[[i]] &lt;- list(left[i], width[i])
  }

  out
}</code></pre>
<p>Example:</p>
<pre class="r"><code>sales %&gt;%
  mutate(timeline = convert_timestamps(enter, exit))</code></pre>
<pre><code>## # A tibble: 10 x 5
##     c_id revenue enter  exit   timeline  
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;time&gt; &lt;time&gt; &lt;list&gt;    
##  1     1  23.3   18:41  19:44  &lt;list [2]&gt;
##  2     2  21.4   08:55  09:49  &lt;list [2]&gt;
##  3     3  44.9   17:37  19:07  &lt;list [2]&gt;
##  4     4  57.2   11:37  13:28  &lt;list [2]&gt;
##  5     5  27.6   10:27  11:28  &lt;list [2]&gt;
##  6     6  21.5   12:25  13:20  &lt;list [2]&gt;
##  7     7  50.8   08:48  10:29  &lt;list [2]&gt;
##  8     8  28.9   08:02  09:00  &lt;list [2]&gt;
##  9     9   0.610 09:30  10:02  &lt;list [2]&gt;
## 10    10   5.44  10:07  10:30  &lt;list [2]&gt;</code></pre>
</div>
<div id="step-2-define-html-helper" class="section level3">
<h3>Step 2: Define html helper</h3>
<p><code>reactable()</code> will feed output from <code>convert_timestamps</code> into <code>create_timeline_bar</code>, producing our final output.</p>
<pre class="r"><code>create_timeline_bar &lt;- function(left = 0, width = &quot;100%&quot;, fill = &quot;#00bfc4&quot;) {
  left &lt;- scales::percent(left)
  width &lt;- scales::percent(width)

  bar &lt;- div(style = list(
    position = &quot;absolute&quot;,
    left = left,
    background = fill,
    width = width,
    height = &quot;140%&quot;)
  )

  chart &lt;- div(style = list(
    flexGrow = 1,
    position = &quot;relative&quot;,
    display = &quot;flex&quot;,
    alignItems = &quot;center&quot;,
    height = &quot;100%&quot;
  ),
  bar)

  div(style = list(
    height = &quot;100%&quot;
  ),
  chart)
}</code></pre>
</div>
<div id="final-product" class="section level3">
<h3>Final product</h3>
<pre class="r"><code>sales %&gt;%
  mutate(timeline = convert_timestamps(enter, exit)) %&gt;%
  # ^ created in Step 1
  reactable(fullWidth = FALSE,
            compact = TRUE,
            bordered = TRUE,
            columns = list(
              c_id = colDef(width = 55),
              revenue = colDef(width = 90, show = FALSE, format = colFormat(digits = 1)),
              enter = colDef(width = 80),
              exit = colDef(width = 80),
              timeline = colDef(
                width = 90,
                cell = function(value) {
                  create_timeline_bar(left = value[[1]], width = value[[2]])
                  # ^ created in Step 2
                }
              )
            )
  )</code></pre>
<div id="htmlwidget-2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"c_id":[1,2,3,4,5,6,7,8,9,10],"revenue":[23.2980777195814,21.4335567209224,44.8611822126433,57.2003552325714,27.6266204817329,21.4633937190885,50.8019767005564,28.8549955645461,0.610091666646836,5.44092230565478],"enter":["18:41:00","08:55:00","17:37:00","11:37:00","10:27:00","12:25:00","08:48:00","08:02:00","09:30:00","10:07:00"],"exit":["19:44:00","09:49:00","19:07:00","13:28:00","11:28:00","13:20:00","10:29:00","09:00:00","10:02:00","10:30:00"],"timeline":[[[0.91025641025641],[0.0897435897435897]],[[0.0754985754985755],[0.0769230769230769]],[[0.819088319088319],[0.128205128205128]],[[0.306267806267806],[0.158119658119658]],[[0.206552706552707],[0.0868945868945869]],[[0.374643874643875],[0.0783475783475783]],[[0.0655270655270655],[0.143874643874644]],[[0],[0.0826210826210826]],[[0.125356125356125],[0.0455840455840456]],[[0.178062678062678],[0.0327635327635328]]]},"columns":[{"accessor":"c_id","name":"c_id","type":"numeric","width":55},{"accessor":"revenue","name":"revenue","type":"numeric","show":false,"format":{"cell":{"digits":1},"aggregated":{"digits":1}},"width":90},{"accessor":"enter","name":"enter","type":["hms","difftime"],"width":80},{"accessor":"exit","name":"exit","type":["hms","difftime"],"width":80},{"accessor":"timeline","name":"timeline","type":"list","cell":[{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"91%","background":"#00bfc4","width":"9%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"8%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"82%","background":"#00bfc4","width":"13%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"31%","background":"#00bfc4","width":"16%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"21%","background":"#00bfc4","width":"9%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"37%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"7%","background":"#00bfc4","width":"14%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"0%","background":"#00bfc4","width":"8%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"13%","background":"#00bfc4","width":"5%","height":"140%"}},"children":[]}]}]},{"name":"div","attribs":{"style":{"height":"100%"}},"children":[{"name":"div","attribs":{"style":{"flexGrow":1,"position":"relative","display":"flex","alignItems":"center","height":"100%"}},"children":[{"name":"div","attribs":{"style":{"position":"absolute","left":"18%","background":"#00bfc4","width":"3%","height":"140%"}},"children":[]}]}]}],"width":90}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"bordered":true,"compact":true,"inline":true,"dataKey":"371375ac302dd55688c5c22021959b41","key":"371375ac302dd55688c5c22021959b41"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p><br></p>
</div>
